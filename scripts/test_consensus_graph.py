from consensus_graph import *
#reads = ["GAAAAAAGTGAAACTCTGTCNCAAAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGCAGCCAGATGA","AAAANTGAAACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCA","AAAAGTGAAGCTCTGTCTCAAAATGAATGGATGAATGAATGAATGNATGAATGAATAAAAGACGCCAGATGAACG","AAAGTGAAACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATAAAA","AAAGTGAAACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATGAAAAAAAGACGCCAG","AAAGTGAAACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGATGAACGG","AAGTGAAACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATGAATA","AAGTNAAACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGA","AAGTGAAACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGAT","AGTGNAACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGAT","AGTGAAACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGATGAACGGCT","GTGAAACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGAC","GTGAAACTCTGTCTCAAAATGAATGAATGAATGAATGAATGATTGAATNAATAAGTAAAAGACGCCAG","GTGAAACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGATG","GTGAAACTCTGTCTCAAAATGAATGAATAAATGAATGAATGAATGAATGAATAAAAGACGCCAGATGAACGGCTC","TGAAACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGATGAA","TGAAACTCTGTCTNAAAATGAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGATGAACGG","TGAAACTCTGTCTCAAAATGAATGAATGAATGANTGAATGAATGAATGAATGAATAAAAGACGCCAGATGAACGGCTCAA","GAAACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGATGAACGGCT","GAAACTCTGGCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGTGGAACGGCTCAA","GAAACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGNTGAACGGCTCAAC","AAACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCC","AAACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGAC","GAACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCNAGATGAACGGCTCAACA","AACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGAC","AACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACG","AACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGATGA","AACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGATGAACGGCTC","ACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAG","ACTCTGTCTCAAAATGAATGAATGAATGNATGAATGAATGAATGAATAAAAGACGCCAGATGA","TCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGATGAACGGCTC","TGGCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGATGAACGGC","GTCTCAAAATGAATGAATGAATGAATGAATGAANGAATGAATAAAAGACGCCAGATGAACGGCTCAAC","TCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGATGAACGGCTCAANA","TCAAAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGATGAA","TCAAAATGAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGATGAACGGCTCAA","CAAAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGATGAAC","AAAATGAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGATGAACGGCTCAACA"]
#refseq = "GAAACTCTGTCTCAAAATGAATGAATGAATGAATGAATGAATGAATGAATAAAAGACGCCAGATG"

#cs = Consensus(reads, refseq)

f = open("/san/melissa/margulies/consensus/Margulies_v1.0.6_2.genotypes.tab","r")
#f = open("/san/melissa/margulies/consensus/test_hom.genotypes.tab","r")
line = f.readline()
while line != "":
    if "#" in line: pass
    reads = [item.split(":")[0] for item in line.strip().split("\t")[-1].split(",")]
    if len(reads) >=20 :
        name= "_".join(line.split("\t")[0:4])
        print name
        cs = Consensus(reads,"",name)
    line = f.readline()

f.close()
